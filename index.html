<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Memory Garden Brick Order</title>

<style>
:root{
  --border:#d9d9d9;
  --text:#111;
  --muted:#555;
  --ok:#2e7d32;
  --okBg:#e8f5e9;
  --err:#b00020;
  --errBg:#ffebee;
}

*{box-sizing:border-box}

body{
  margin:0;
  padding:24px 14px;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  background:#fff;
  color:var(--text);
}

.wrap{max-width:980px;margin:auto}

.card{
  border:1px solid var(--border);
  border-radius:14px;
  background:#fff;
  overflow:hidden;
}

/* ===== HEADER IMAGE ===== */
.header-image{
  width:100%;
  height:260px;
  background-image:url("https://raw.githubusercontent.com/vumc-media/brick-garden-form/main/Memory%20Garden.png");
  background-size:cover;
  background-position:center;
  position:relative;
}
.header-image::after{
  content:"";
  position:absolute;
  bottom:0;
  left:0;
  right:0;
  height:70px;
  background:linear-gradient(to bottom, rgba(255,255,255,0), #fff);
}
@media(max-width:700px){ .header-image{height:180px} }
@media print{ .header-image{display:none} }

.content{padding:22px}

h1{margin:0 0 8px;font-size:26px}
.sub{margin:0 0 14px;color:var(--muted);font-size:14.5px;line-height:1.45}

.pillrow{display:flex;gap:10px;flex-wrap:wrap;margin:12px 0 18px}
.pill{
  border:1px solid var(--border);
  border-radius:999px;
  padding:8px 12px;
  font-size:13px;
  color:var(--muted);
}

.grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:14px;
}
@media(max-width:760px){ .grid{grid-template-columns:1fr} }

label{display:block;font-size:13px;color:var(--muted);margin-bottom:6px}

input,select,textarea{
  width:100%;
  padding:11px 12px;
  border-radius:10px;
  border:1px solid var(--border);
  font-size:14.5px;
}
textarea{min-height:90px}

.section{margin-top:18px}
.section h3{margin:0 0 6px;font-size:16px}
.help{font-size:13px;color:var(--muted);line-height:1.45;margin:0 0 10px}

.total{
  margin-top:14px;
  padding:14px 16px;
  border:2px solid #000;
  border-radius:12px;
  background:#fafafa;
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:14px;
}
.total .amt{font-size:22px;font-weight:900}

.buttons{margin-top:18px;display:flex;gap:12px;flex-wrap:wrap}
button{
  padding:11px 16px;
  border-radius:10px;
  border:none;
  font-weight:750;
  cursor:pointer;
  background:#111;
  color:#fff;
}
button.secondary{
  background:#fff;
  color:#111;
  border:1px solid var(--border);
}
button:disabled{opacity:.6;cursor:not-allowed}

.status{
  margin-top:16px;
  padding:12px 14px;
  border-radius:12px;
  display:none;
}
.status.ok{display:block;border:1px solid var(--ok);background:var(--okBg)}
.status.err{display:block;border:1px solid var(--err);background:var(--errBg)}

.fineprint{margin-top:16px;font-size:12.5px;color:var(--muted)}
.req{color:var(--err);font-weight:700}

.paverCard{
  border:1px solid var(--border);
  border-radius:12px;
  padding:14px;
  margin-top:12px;
  background:#fff;
}
.paverHeader{
  display:flex;
  justify-content:space-between;
  align-items:flex-end;
  gap:10px;
  margin-bottom:10px;
}
.paverTitle{font-weight:900;font-size:15px}
.paverMeta{font-size:12.5px;color:var(--muted)}
.mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;}
hr.sep{border:none;border-top:1px solid var(--border);margin:14px 0}
.smallNote{font-size:12.5px;color:var(--muted);margin-top:6px}
</style>
</head>

<body>
<div class="wrap">
  <div class="card">
    <div class="header-image" role="img" aria-label="Memory Garden brick walkway"></div>

    <div class="content">
      <h1>Memory Garden Brick Order</h1>
      <p class="sub">
        Purchase brick pavers for our memorial garden.
        <strong>Payment by Check or Money Order only.</strong>
      </p>

      <div class="pillrow">
        <div class="pill"><strong>Price:</strong> $75 per paver</div>
        <div class="pill"><strong>Inscription:</strong> 3 lines · 20 characters each</div>
        <div class="pill"><strong>Payment:</strong> Check or Money Order</div>
      </div>

      <form id="orderForm">
        <div class="section">
          <h3>Purchaser Information</h3>
          <div class="grid">
            <div>
              <label>Full Name <span class="req">*</span></label>
              <input id="fullName" required>
            </div>
            <div>
              <label>Email <span class="req">*</span></label>
              <input id="email" type="email" required>
            </div>
            <div>
              <label>Mobile Number <span class="req">*</span></label>
              <input id="mobile" required>
            </div>
            <div>
              <label>&nbsp;</label>
              <div class="smallNote">
                Add one or more pavers below using the buttons.
              </div>
            </div>
          </div>
        </div>

        <div class="total">
          <div>
            <div class="help"><strong>Amount to write check for:</strong></div>
            <div class="amt">$<span id="total">75.00</span></div>
            <div class="smallNote"><span id="countText">1</span> paver(s) × $75</div>
          </div>
          <div class="help">
            Make payable to<br>
            <strong>Versailles United Methodist Church</strong>
          </div>
        </div>

        <p class="help" style="margin-top:10px;">
          <strong>Pavers in this order:</strong> <span id="countTextInline">1</span>
        </p>

        <div class="section">
          <h3>Paver Details</h3>
          <p class="help">
            If purchasing multiple pavers, you can set a different dedication (and inscription) for each paver.
          </p>

          <div class="buttons" style="margin-top:10px">
            <button type="button" id="addPaverBtn">Add Another Paver</button>
            <button type="button" class="secondary" id="removePaverBtn">Remove Last Paver</button>
          </div>

          <div id="paversWrap"></div>
        </div>

        <div class="section">
          <h3>Order Notes (optional)</h3>
          <textarea id="notes" placeholder="Anything else we should know?"></textarea>
        </div>

        <div class="buttons">
          <button id="submitBtn" type="submit">Submit Brick Order</button>
          <button type="reset" class="secondary">Clear</button>
        </div>

        <div id="status" class="status"></div>

        <div class="fineprint">
          Checks or money orders should be payable to <strong>Versailles United Methodist Church</strong>.
        </div>
      </form>
    </div>
  </div>
</div>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzGRk-ePEiBlKt3E86tDmpqwlmfpOUzygVyJHePjoVqEWh_Hne74BH6Y1lf0EW6BtVvdQ/exec";
const PRICE = 75;

const paversWrap = document.getElementById("paversWrap");
const totalEl = document.getElementById("total");
const countText = document.getElementById("countText");
const countTextInline = document.getElementById("countTextInline");
const statusBox = document.getElementById("status");
const submitBtn = document.getElementById("submitBtn");

function paverTemplate(i){
  const n = i + 1;
  return `
    <div class="paverCard" data-paver-index="${i}">
      <div class="paverHeader">
        <div>
          <div class="paverTitle">Paver #${n}</div>
          <div class="paverMeta">Dedication & inscription for this paver</div>
        </div>
        <div class="paverMeta">Max 20 characters per line</div>
      </div>

      <div class="grid">
        <div>
          <label>Dedication Type (optional)</label>
          <select class="dedicationType">
            <option value="">— Select —</option>
            <option>In Memory Of</option>
            <option>In Honor Of</option>
            <option>Special Occasion</option>
            <option>Other</option>
          </select>
        </div>
        <div>
          <label>Name / Occasion (optional)</label>
          <input class="honoree" placeholder="e.g., John & Mary Smith">
        </div>
      </div>

      <hr class="sep"/>

      <label>Inscription (optional)</label>
      <div class="grid">
        <div>
          <label style="margin-top:0">Line 1</label>
          <input class="line1 mono" maxlength="20" placeholder="Line 1">
        </div>
        <div>
          <label style="margin-top:0">Line 2</label>
          <input class="line2 mono" maxlength="20" placeholder="Line 2">
        </div>
      </div>
      <div style="margin-top:10px">
        <label>Line 3</label>
        <input class="line3 mono" maxlength="20" placeholder="Line 3">
      </div>
    </div>
  `;
}

function getPaverCount(){
  return paversWrap.querySelectorAll(".paverCard").length;
}

function updateTotals(){
  const count = getPaverCount();
  countText.textContent = String(count);
  countTextInline.textContent = String(count);
  totalEl.textContent = (count * PRICE).toFixed(2);
  document.getElementById("removePaverBtn").disabled = count <= 1;
}

function addPaver(){
  const i = getPaverCount();
  paversWrap.insertAdjacentHTML("beforeend", paverTemplate(i));
  updateTotals();
}

function removePaver(){
  const cards = paversWrap.querySelectorAll(".paverCard");
  if(cards.length <= 1) return;
  cards[cards.length - 1].remove();
  updateTotals();
}

function showStatus(type, html){
  statusBox.className = "status " + (type === "ok" ? "ok" : "err");
  statusBox.innerHTML = html;
  statusBox.style.display = "block";
  statusBox.scrollIntoView({behavior:"smooth", block:"nearest"});
}

function clearStatus(){
  statusBox.className = "status";
  statusBox.style.display = "none";
  statusBox.innerHTML = "";
}

function clean(s){
  return (s || "").toString().replace(/\s+/g, " ").trim();
}

function gatherPavers(){
  const cards = paversWrap.querySelectorAll(".paverCard");
  const pavers = [];
  cards.forEach((card) => {
    pavers.push({
      dedicationType: clean(card.querySelector(".dedicationType")?.value),
      honoree: clean(card.querySelector(".honoree")?.value),
      inscription: {
        line1: clean(card.querySelector(".line1")?.value).slice(0,20),
        line2: clean(card.querySelector(".line2")?.value).slice(0,20),
        line3: clean(card.querySelector(".line3")?.value).slice(0,20),
      }
    });
  });
  return pavers;
}

// Init with 1 paver
addPaver();

document.getElementById("addPaverBtn").addEventListener("click", addPaver);
document.getElementById("removePaverBtn").addEventListener("click", removePaver);

document.getElementById("orderForm").addEventListener("reset", () => {
  setTimeout(() => {
    paversWrap.innerHTML = "";
    addPaver();
    clearStatus();
  }, 0);
});

document.getElementById("orderForm").addEventListener("submit", async (e) => {
  e.preventDefault();
  clearStatus();

  const fullName = clean(document.getElementById("fullName").value);
  const email = clean(document.getElementById("email").value);
  const mobile = clean(document.getElementById("mobile").value);

  if(!fullName || !email || !mobile){
    showStatus("err", "Please fill out <strong>Name, Email,</strong> and <strong>Mobile Number</strong>.");
    return;
  }

  const pavers = gatherPavers();
  const qty = pavers.length;

  const payload = {
    fullName,
    email,
    mobile,
    qty,
    priceEach: PRICE,
    total: qty * PRICE,
    pavers,
    notes: clean(document.getElementById("notes").value),
    submittedAtLocal: new Date().toString()
  };

  submitBtn.disabled = true;
  submitBtn.textContent = "Submitting...";

  try{
    const res = await fetch(SCRIPT_URL,{
      method:"POST",
      headers:{ "Content-Type":"text/plain;charset=utf-8" },
      body: JSON.stringify(payload)
    });

    const data = await res.json().catch(() => ({}));
    if(data && data.ok){
      showStatus("ok",
        `<strong>Success!</strong> Your order was submitted.<br>
         Please write your check for <strong>$${(qty*PRICE).toFixed(2)}</strong>.`
      );
      e.target.reset();
    } else {
      showStatus("err", `<strong>Error:</strong> ${(data && data.error) ? data.error : "Submission failed."}`);
    }
  }catch(err){
    showStatus("err", `<strong>Error:</strong> ${err.message}`);
  }finally{
    submitBtn.disabled = false;
    submitBtn.textContent = "Submit Brick Order";
  }
});
</script>
</body>
</html>
